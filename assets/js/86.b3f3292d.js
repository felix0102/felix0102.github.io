(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{262:function(e,t,a){"use strict";a.r(t);var s=a(6),l=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"查看scn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看scn"}},[e._v("#")]),e._v(" 查看SCN")]),e._v(" "),a("ul",[a("li",[e._v("select dbms_flashback.get_system_change_number from dual;\n可以理解，这里返回的SCN，也是目前redo log file最新的SCN纪录。因为commit后的交易才会有SCN，而一旦commit就会立刻写入redo log file中。")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GET_SYSTEM_CHANGE_NUMBER\n------------------------\n                15351432\n")])])]),a("ul",[a("li",[a("p",[e._v("select checkpoint_change# from v$database")])]),e._v(" "),a("li",[a("p",[e._v("select GROUP#, STATUS, FIRST_CHANGE# from v$log;")])])]),e._v(" "),a("h3",{attrs:{id:"scn-概念说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scn-概念说明"}},[e._v("#")]),e._v(" SCN  概念说明")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("透析SCN号\n\nSCN是当Oracle数据库更新后，由DBMS自动维护去累积递增的一个数字。当一笔交易commit时，LGWR会将log buffer写入redo log file，同时也会将该笔交易的SCN同步写入到redo log file内（wait-until-completed）。因此当你commit transaction时，在交易成功的讯息返回之前，LGWR必须先完整的完成上述行为之后，否则你是看不到提交成功的回应讯息。\n\n可以查询目前系统最新的SCN\nSQL>select dbms_flashback.get_system_change_number from dual;\n\n可以理解，这里返回的SCN，也是目前redo log file最新的SCN纪录。因为commit后的交易才会有SCN，而一旦commit就会立刻写入redo log file中。\n\nCHECKPOINT和SCN的关联\nCheckpoint发生的目的就是要把存储在buffer内的已提交交易写回disk，否则一旦发生crash，需要进行recovery时，就必须花很多时间从redo log file内最后的SCN交易开始进行recovery，这样在商业应用上是很浪费时间和没有效率的。\n\n当commit一笔交易时，只会立刻将redo buffer写入redo log file内，但是并不会马上将该update后的block（dirty block）同步写回disk datafile中，这是为了减少过多disk IO，所以采取batch方式写入。\n\nWhen a checkpoint occurs. Oracle must update the headers of all datafiles to record the details of the checkpoint.  This is done by the CKPT process.  The CKPT process does not write blocks to disk; DBWn always performs that work.\n\n在shutdown normal or shutdown immediate下，也就是所谓的clean shutdown, checkpoint也会自动触发。当发生checkpoint时，会把SCN写到四个地方去。三个地方在control file 内，一个在datafile hea\n")])])]),a("h3",{attrs:{id:"reference-link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference-link"}},[e._v("#")]),e._v(" Reference Link")]),e._v(" "),a("ul",[a("li",[e._v("https://blog.csdn.net/weixin_42774383/article/details/97629541")])])])}),[],!1,null,null,null);t.default=l.exports}}]);