<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>配置vsftp服务器 | Some of my notes</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Hello, VuePress!">
    <link rel="preload" href="/assets/css/0.styles.ccac5a78.css" as="style"><link rel="preload" href="/assets/js/app.1bdc9612.js" as="script"><link rel="preload" href="/assets/js/2.1ce52c5d.js" as="script"><link rel="preload" href="/assets/js/31.dbfd828d.js" as="script"><link rel="prefetch" href="/assets/js/10.7604792c.js"><link rel="prefetch" href="/assets/js/100.54bb7d3b.js"><link rel="prefetch" href="/assets/js/101.93f1ea81.js"><link rel="prefetch" href="/assets/js/102.44c6dc4c.js"><link rel="prefetch" href="/assets/js/11.fbfee2dd.js"><link rel="prefetch" href="/assets/js/12.47589572.js"><link rel="prefetch" href="/assets/js/13.da8d1a6c.js"><link rel="prefetch" href="/assets/js/14.6a411613.js"><link rel="prefetch" href="/assets/js/15.d3299691.js"><link rel="prefetch" href="/assets/js/16.6529f869.js"><link rel="prefetch" href="/assets/js/17.3abce8c1.js"><link rel="prefetch" href="/assets/js/18.d321540d.js"><link rel="prefetch" href="/assets/js/19.9b0c4efe.js"><link rel="prefetch" href="/assets/js/20.bdfdc27a.js"><link rel="prefetch" href="/assets/js/21.a197c78c.js"><link rel="prefetch" href="/assets/js/22.11e43f38.js"><link rel="prefetch" href="/assets/js/23.8ed6a2cd.js"><link rel="prefetch" href="/assets/js/24.c0aafb51.js"><link rel="prefetch" href="/assets/js/25.a251ec12.js"><link rel="prefetch" href="/assets/js/26.9c73ce08.js"><link rel="prefetch" href="/assets/js/27.0f68e974.js"><link rel="prefetch" href="/assets/js/28.dda890e2.js"><link rel="prefetch" href="/assets/js/29.e4c94034.js"><link rel="prefetch" href="/assets/js/3.50744ef0.js"><link rel="prefetch" href="/assets/js/30.6a2b5705.js"><link rel="prefetch" href="/assets/js/32.4ec21949.js"><link rel="prefetch" href="/assets/js/33.31d58b63.js"><link rel="prefetch" href="/assets/js/34.ab44651b.js"><link rel="prefetch" href="/assets/js/35.78e82986.js"><link rel="prefetch" href="/assets/js/36.00c61c64.js"><link rel="prefetch" href="/assets/js/37.1eb74be4.js"><link rel="prefetch" href="/assets/js/38.3e813362.js"><link rel="prefetch" href="/assets/js/39.647b508b.js"><link rel="prefetch" href="/assets/js/4.a7ac34a6.js"><link rel="prefetch" href="/assets/js/40.c783cf11.js"><link rel="prefetch" href="/assets/js/41.40bb819b.js"><link rel="prefetch" href="/assets/js/42.487d2b5b.js"><link rel="prefetch" href="/assets/js/43.cd2ed31c.js"><link rel="prefetch" href="/assets/js/44.212273f2.js"><link rel="prefetch" href="/assets/js/45.2d56bfe3.js"><link rel="prefetch" href="/assets/js/46.745a74a8.js"><link rel="prefetch" href="/assets/js/47.20d54662.js"><link rel="prefetch" href="/assets/js/48.24df1f1f.js"><link rel="prefetch" href="/assets/js/49.efe4f912.js"><link rel="prefetch" href="/assets/js/5.a6bf4d86.js"><link rel="prefetch" href="/assets/js/50.240683fd.js"><link rel="prefetch" href="/assets/js/51.69d75721.js"><link rel="prefetch" href="/assets/js/52.3e48cd30.js"><link rel="prefetch" href="/assets/js/53.3f5efb27.js"><link rel="prefetch" href="/assets/js/54.84e054cb.js"><link rel="prefetch" href="/assets/js/55.dd74fcad.js"><link rel="prefetch" href="/assets/js/56.2cdddc9b.js"><link rel="prefetch" href="/assets/js/57.31388f8e.js"><link rel="prefetch" href="/assets/js/58.1cf23f34.js"><link rel="prefetch" href="/assets/js/59.a66bc6e3.js"><link rel="prefetch" href="/assets/js/6.5666a477.js"><link rel="prefetch" href="/assets/js/60.2f9ad10d.js"><link rel="prefetch" href="/assets/js/61.ca08e66b.js"><link rel="prefetch" href="/assets/js/62.73b03dc4.js"><link rel="prefetch" href="/assets/js/63.95143f10.js"><link rel="prefetch" href="/assets/js/64.ca12f361.js"><link rel="prefetch" href="/assets/js/65.c9868457.js"><link rel="prefetch" href="/assets/js/66.d961caec.js"><link rel="prefetch" href="/assets/js/67.f4463c14.js"><link rel="prefetch" href="/assets/js/68.763e362c.js"><link rel="prefetch" href="/assets/js/69.eb5440bc.js"><link rel="prefetch" href="/assets/js/7.e50c1d2e.js"><link rel="prefetch" href="/assets/js/70.13b90785.js"><link rel="prefetch" href="/assets/js/71.fb6f6189.js"><link rel="prefetch" href="/assets/js/72.17356d70.js"><link rel="prefetch" href="/assets/js/73.8037a311.js"><link rel="prefetch" href="/assets/js/74.e1fecc35.js"><link rel="prefetch" href="/assets/js/75.75ac11fd.js"><link rel="prefetch" href="/assets/js/76.2a376568.js"><link rel="prefetch" href="/assets/js/77.2f912849.js"><link rel="prefetch" href="/assets/js/78.cb45b9f4.js"><link rel="prefetch" href="/assets/js/79.e99f3946.js"><link rel="prefetch" href="/assets/js/8.a7bf67bd.js"><link rel="prefetch" href="/assets/js/80.98f7a9b8.js"><link rel="prefetch" href="/assets/js/81.77673ce8.js"><link rel="prefetch" href="/assets/js/82.6da9e559.js"><link rel="prefetch" href="/assets/js/83.a226a6f5.js"><link rel="prefetch" href="/assets/js/84.149db13e.js"><link rel="prefetch" href="/assets/js/85.a0f59112.js"><link rel="prefetch" href="/assets/js/86.b3f3292d.js"><link rel="prefetch" href="/assets/js/87.17a04e28.js"><link rel="prefetch" href="/assets/js/88.0a2115b8.js"><link rel="prefetch" href="/assets/js/89.31db3c7e.js"><link rel="prefetch" href="/assets/js/9.90e0f26f.js"><link rel="prefetch" href="/assets/js/90.c81c9788.js"><link rel="prefetch" href="/assets/js/91.244d9fab.js"><link rel="prefetch" href="/assets/js/92.40c1f6fa.js"><link rel="prefetch" href="/assets/js/93.6e11e9dd.js"><link rel="prefetch" href="/assets/js/94.5f3326b2.js"><link rel="prefetch" href="/assets/js/95.ee7c907b.js"><link rel="prefetch" href="/assets/js/96.1cc91fcf.js"><link rel="prefetch" href="/assets/js/97.380010c8.js"><link rel="prefetch" href="/assets/js/98.dba928b5.js"><link rel="prefetch" href="/assets/js/99.bcb7b171.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccac5a78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Some of my notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/shell/" class="nav-link">
  Shell
</a></div><div class="nav-item"><a href="/open-source/" class="nav-link">
  open-source
</a></div><div class="nav-item"><a href="/mac/" class="nav-link router-link-active">
  Mac
</a></div><div class="nav-item"><a href="/oracle/" class="nav-link">
  Oracle
</a></div><div class="nav-item"><a href="/oci/" class="nav-link">
  OCI
</a></div><div class="nav-item"><a href="/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/more/" class="nav-link">
  More
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/shell/" class="nav-link">
  Shell
</a></div><div class="nav-item"><a href="/open-source/" class="nav-link">
  open-source
</a></div><div class="nav-item"><a href="/mac/" class="nav-link router-link-active">
  Mac
</a></div><div class="nav-item"><a href="/oracle/" class="nav-link">
  Oracle
</a></div><div class="nav-item"><a href="/oci/" class="nav-link">
  OCI
</a></div><div class="nav-item"><a href="/spring/" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/more/" class="nav-link">
  More
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>mac</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mac/" aria-current="page" class="sidebar-link">首页</a></li><li><a href="/mac/mac-black-apple.html" class="sidebar-link">make bootup disk</a></li><li><a href="/mac/mac-launchctl-plist.html" class="sidebar-link">launchctl plist</a></li><li><a href="/mac/mac-mail.html" class="sidebar-link">Terminal You have new mail</a></li><li><a href="/mac/mac-route-list.html" class="sidebar-link">mac routing operation</a></li><li><a href="/mac/mac-vsftp.html" aria-current="page" class="active sidebar-link">配置vsftp服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#安装brew" class="sidebar-link">安装brew</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#安装vsftpd" class="sidebar-link">安装vsftpd</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#修改配置文件vsftpd-conf" class="sidebar-link">修改配置文件vsftpd.conf：</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#新建一个用户" class="sidebar-link">新建一个用户：</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#重启vsftpd" class="sidebar-link">重启vsftpd</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#修改默认目录" class="sidebar-link">修改默认目录</a></li><li class="sidebar-sub-header"><a href="/mac/mac-vsftp.html#默认上传文件权限" class="sidebar-link">默认上传文件权限</a></li></ul></li><li><a href="/mac/mail.html" class="sidebar-link">避免 Mac 邮件正文变成 HTML 附件的问题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="安装brew"><a href="#安装brew" class="header-anchor">#</a> 安装brew</h2> <blockquote><p>用mac自带的mac下载，去https://brew.sh/index_zh-cn.html 复制命令</p></blockquote> <h2 id="安装vsftpd"><a href="#安装vsftpd" class="header-anchor">#</a> 安装vsftpd</h2> <ul><li>brew install vsftpd</li> <li>brew安装完vsftpd后会给出以下提示：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>To use chroot, vsftpd requires root privileges, so you will need to run
sudo vsftpd.
You should be certain that you trust any software you grant root privileges.

The vsftpd.conf file must be owned by root or vsftpd will refuse to start:
sudo chown root /usr/local/etc/vsftpd.conf

To have launchd start vsftpd now and restart at startup:
sudo brew services start vsftpd
Or, if you don’t want/need a background service you can just run:
sudo vsftpd
</code></pre></div><blockquote><p>运行命令：sudo chown root /usr/local/etc/vsftpd.conf</p></blockquote> <h2 id="修改配置文件vsftpd-conf"><a href="#修改配置文件vsftpd-conf" class="header-anchor">#</a> 修改配置文件vsftpd.conf：</h2> <ul><li>local_enable=YES</li> <li>write_enable=YES</li></ul> <h2 id="新建一个用户"><a href="#新建一个用户" class="header-anchor">#</a> 新建一个用户：</h2> <p>ftp1，并设置密码。mac中不能使用命令useradd，所以要到系统偏好设置-&gt;用户与群主 中新增用户。
启动vaftpd：sudo brew services start vsftpd
在/etc/shells中新增/bin/false和/sbin/nologin，这样可以允许ftp登录，禁止ssh登录，如果没有这个需要可以不用设置。
用ftp1登录，可能会报以下错误</p> <h2 id="重启vsftpd"><a href="#重启vsftpd" class="header-anchor">#</a> 重启vsftpd</h2> <p>sudo brew services restart vsftpd, 重新登录ftp1,报错：
331 Please specify the password. 530 Login incorrect.
解决方法：</p> <p>cd /etc/pam.d, 找到ftp server的名字，我找到的是ftpd。
在vsftpd.conf加上pam_service_name=ftpd</p> <p>重启vsftpd</p> <p>上述步骤完成之后就可以使用127.0.0.1访问该ftp服务器了。</p> <h2 id="修改默认目录"><a href="#修改默认目录" class="header-anchor">#</a> 修改默认目录</h2> <div class="language- extra-class"><pre class="language-text"><code>修改ftp的根目录只要修改/usr/local/etc/vsftpd.conf文件即可：

加入如下几行：

local_root=/var/www/html
chroot_local_user=YES
anon_root=/var/www/html

注：local_root 针对系统用户；anon_root 针对匿名用户。
</code></pre></div><h2 id="默认上传文件权限"><a href="#默认上传文件权限" class="header-anchor">#</a> 默认上传文件权限</h2> <div class="language- extra-class"><pre class="language-text"><code>file_open_mode=0777
local_umask=022
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mac/mac-route-list.html" class="prev">
        mac routing operation
      </a></span> <span class="next"><a href="/mac/mail.html">
        避免 Mac 邮件正文变成 HTML 附件的问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1bdc9612.js" defer></script><script src="/assets/js/2.1ce52c5d.js" defer></script><script src="/assets/js/31.dbfd828d.js" defer></script>
  </body>
</html>
